<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Browse Acts | Geneius Entertainment</title>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-MR1NLPH5ZK"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-MR1NLPH5ZK');
  </script>

  <style>
    :root{ --bg:#000; --ink:#f5f5f5; --muted:#bfbfbf; --gold:#C99700; --panel:#15151b; --line:rgba(255,255,255,.12); }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--ink);font-family:"Trebuchet MS",Arial,sans-serif}

    .wrap{width:min(1120px,92vw);margin:0 auto;padding:28px 0 40px}
    header{display:flex;align-items:center;gap:16px;justify-content:center;margin:8px 0 18px}
    header img{height:70px;width:auto}
    h1{margin:6px 0 0;font-size:1.6rem;color:var(--gold);letter-spacing:1px}
    p.sub{color:var(--muted);margin:0 0 14px;text-align:center}

    .bar{display:flex;justify-content:space-between;align-items:center;margin:0 0 12px}
    .btn-mini{
      display:inline-block;padding:8px 12px;border-radius:10px;
      color:#ffd76a;background:rgba(201,151,0,.08);
      border:1px solid rgba(201,151,0,.45);text-decoration:none;font-weight:700
    }
    .btn-mini:hover{background:rgba(201,151,0,.14)}

    .grid{display:grid;gap:16px;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));margin-top:8px}

    /* Card (uniform sizing) */
    .artist-card{
      position:relative; overflow:hidden; border-radius:14px;
      background:var(--panel); border:1px solid var(--line);
      transition:transform .18s, box-shadow .18s, border-color .18s;
    }
    .artist-card:hover{transform:translateY(-2px);box-shadow:0 6px 18px rgba(0,0,0,.35);border-color:rgba(212,175,55,.45)}

    /* Media frame – fixed height */
    .frame{position:relative; height:220px; overflow:hidden}
    .slides{display:flex; width:100%; height:100%; transition:transform .35s ease}
    .slides img{width:100%; height:100%; object-fit:cover; flex:0 0 100%; display:block}

    /* Gallery controls */
    .nav{
      position:absolute; top:50%; transform:translateY(-50%);
      background:rgba(0,0,0,.45); color:#fff; border:1px solid rgba(255,255,255,.35);
      font-weight:800; line-height:1; padding:.35rem .6rem; border-radius:10px;
      cursor:pointer; opacity:.9;
    }
    .nav.prev{left:8px} .nav.next{right:8px}
    .dots{position:absolute; left:0; right:0; bottom:8px; display:flex; gap:6px; justify-content:center}
    .dot{width:8px;height:8px;border-radius:50%;background:rgba(255,255,255,.35);border:1px solid rgba(255,255,255,.4);cursor:pointer}
    .dot.active{background:#ffd76a;border-color:var(--gold)}

    /* Meta under image */
    .artist-meta{padding:12px 14px}
    .artist-meta .name{
      color:var(--gold); text-transform:uppercase; letter-spacing:.06em;
      font-weight:800; cursor:pointer; display:inline-block;
    }

    /* Bio overlay */
    .bio{
      position:absolute; inset:0; display:flex; flex-direction:column; justify-content:flex-end;
      padding:16px; gap:10px; opacity:0; pointer-events:none; transition:opacity .2s ease;
      background:linear-gradient(to top, rgba(0,0,0,.82) 28%, rgba(0,0,0,.18) 65%, rgba(0,0,0,0));
      backdrop-filter:saturate(120%) blur(2px);
    }
    /* Show on name hover (desktop) */
    .artist-meta:hover ~ .bio{opacity:1; pointer-events:auto}
    /* Show when toggled (mobile or name click) */
    .artist-card.bio-open .bio{opacity:1; pointer-events:auto}

    .bio h3{margin:0;color:var(--gold);text-transform:uppercase;letter-spacing:.06em;font-size:1rem}
    .bio .tags{margin:0;color:#fdeec0;font-size:.9rem}
    .bio p{margin:0;color:#d9d9d9;line-height:1.45}
    .bio .actions{margin-top:10px;display:flex;gap:8px;flex-wrap:wrap}
    .bio .btn{display:inline-block;background:var(--gold);color:#000;padding:8px 12px;border-radius:8px;font-weight:700;text-decoration:none;border:0}
    .bio .btn.alt{background:transparent;color:#f5f5f5;border:1px solid rgba(255,255,255,.25)}

    .empty{opacity:.7;text-align:center;padding:24px}
    footer{margin-top:26px;color:#aaa;text-align:center;padding-bottom:24px}

    /* Lightbox */
    .lightbox{position:fixed; inset:0; background:rgba(0,0,0,.92); display:none; align-items:center; justify-content:center; z-index:9999}
    .lightbox.open{display:flex}
    .lightbox img{max-width:92vw; max-height:92vh; border:1px solid rgba(255,255,255,.15); border-radius:12px}
    .lightbox .close{position:absolute; top:14px; right:14px; font-size:28px; color:#fff; cursor:pointer}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="bar">
      <a class="btn-mini" href="index.html">← Back to Home</a>
      <a class="btn-mini" href="contact.html">Contact</a>
    </div>

    <header>
      <a href="index.html" aria-label="Home"><img src="logo.png" alt="Geneius Entertainment"></a>
      <h1>Browse all acts</h1>
    </header>
    <p class="sub">Click the <strong>name</strong> for bio & enquiry. Use dots to switch posters. “View Poster” opens a popup.</p>

    <div id="acts-grid" class="grid"></div>

    <footer>© <span id="y"></span> Geneius Entertainment</footer>
  </div>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox" aria-hidden="true">
    <span class="close" aria-label="Close">×</span>
    <img id="lightboxImg" src="" alt="Poster">
  </div>

  <!-- Load your talent list -->
  <script src="talent.js"></script>

  <script>
    document.getElementById('y').textContent = new Date().getFullYear();

    // Safety: TALENT must exist
    const TALENT = Array.isArray(window.TALENT) ? window.TALENT : [];

    const grid = document.getElementById('acts-grid');

    function cardHTML(a, idx){
      const images = Array.isArray(a.images) && a.images.length ? a.images : (a.img ? [a.img] : ['logo.png']);
      const dots = images.map((_,i)=>`<span class="dot${i===0?' active':''}" data-i="${i}"></span>`).join('');
      const tags = (a.tags||[]).join(' • ');
      const nameEsc = (a.name||'').replace(/"/g,'&quot;');

      return `
        <div class="artist-card" tabindex="0" data-name="${nameEsc}" data-index="${idx}">
          <div class="frame gallery" aria-label="Poster gallery for ${nameEsc}">
            <div class="slides">
              ${images.map(src=>`<img src="${src}" alt="${nameEsc} poster">`).join('')}
            </div>
            <button class="nav prev" aria-label="Previous">‹</button>
            <button class="nav next" aria-label="Next">›</button>
            <div class="dots">${dots}</div>
          </div>

          <div class="artist-meta">
            <span class="name" role="button" tabindex="0">${nameEsc}</span>
          </div>

          <div class="bio">
            <h3>${nameEsc}</h3>
            ${tags ? `<p class="tags">${tags}</p>` : ''}
            ${a.bio ? `<p>${a.bio}</p>` : ''}
            <div class="actions">
              <a class="btn enquire" href="#">Enquire</a>
              <a class="btn alt view-poster" href="#" data-target="current">View Poster</a>
            </div>
          </div>
        </div>
      `;
    }

    function render(){
      if(!TALENT.length){
        grid.innerHTML = `<div class="empty">No acts found. Make sure <code>talent.js</code> is present and defines <code>window.TALENT</code>.</div>`;
        return;
      }
      grid.innerHTML = TALENT.map(cardHTML).join('');
      wireUp();
    }

    function wireUp(){
      // gallery
      document.querySelectorAll('.gallery').forEach((root)=>{
        const slides = root.querySelector('.slides');
        const imgs = [...slides.querySelectorAll('img')];
        const prev = root.querySelector('.nav.prev');
        const next = root.querySelector('.nav.next');
        const dotsWrap = root.querySelector('.dots');
        let index = 0;

        function renderGal(){
          slides.style.transform = `translateX(-${index*100}%)`;
          [...dotsWrap.children].forEach((d,i)=>d.classList.toggle('active', i===index));
        }
        function go(i){ index = (i+imgs.length)%imgs.length; renderGal(); }

        prev.addEventListener('click',()=>go(index-1));
        next.addEventListener('click',()=>go(index+1));
        dotsWrap.querySelectorAll('.dot').forEach(d=>{
          d.addEventListener('click',()=>{ go(parseInt(d.dataset.i,10)||0); });
        });

        // touch swipe
        let startX=0, dx=0;
        slides.addEventListener('touchstart', e=>{startX=e.touches[0].clientX; dx=0;}, {passive:true});
        slides.addEventListener('touchmove',  e=>{dx=e.touches[0].clientX-startX;}, {passive:true});
        slides.addEventListener('touchend',   ()=>{ if(Math.abs(dx)>40) go(index + (dx<0?1:-1)); });

        // expose getter
        root.getCurrentSrc = ()=> imgs[index]?.src;

        renderGal();
      });

      // name click toggles bio (and hides when pointer leaves the card)
      document.querySelectorAll('.artist-card').forEach(card=>{
        const nameEl = card.querySelector('.artist-meta .name');
        const bioEl  = card.querySelector('.bio');

        if(nameEl){
          const open = ()=> card.classList.add('bio-open');
          const close= ()=> card.classList.remove('bio-open');

          nameEl.addEventListener('click', open);
          nameEl.addEventListener('keydown', (e)=>{
            if(e.key==='Enter' || e.key===' '){ e.preventDefault(); open(); }
          });

          // hide bio when pointer leaves the card
          card.addEventListener('mouseleave', close);
          // keep open while mouse is over the card
          card.addEventListener('mouseenter', ()=>{ /* no-op */ });
        }
      });

      // Enquire -> contact page with subject
      document.querySelectorAll('.btn.enquire').forEach(btn=>{
        const card = btn.closest('.artist-card');
        const actName = (card?.dataset.name || '').trim();
        btn.href = 'contact.html?subject=' + encodeURIComponent(actName);
      });

      // Lightbox
      const lb = document.getElementById('lightbox');
      const lbImg = document.getElementById('lightboxImg');
      const closeLb = ()=>{ lb.classList.remove('open'); lb.setAttribute('aria-hidden','true'); }
      lb.addEventListener('click', (e)=>{ if(e.target===lb || e.target.classList.contains('close')) closeLb(); });
      document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeLb(); });

      document.querySelectorAll('.view-poster').forEach(btn=>{
        btn.addEventListener('click', e=>{
          e.preventDefault();
          const card = btn.closest('.artist-card');
          const gal = card.querySelector('.gallery');
          const src = gal.getCurrentSrc ? gal.getCurrentSrc() : gal.querySelector('img')?.src;
          if(src){
            lbImg.src = src;
            lb.classList.add('open');
            lb.setAttribute('aria-hidden','false');
          }
        });
      });
    }

    render();
  </script>
</body>
</html>
